<mat-sidenav-container>
    <mat-sidenav #sidenav [opened]="sidenavOpen" [mode]="sidenavOpen ? 'side' : 'over'" class="filter-sidenav" perfectScrollbar>
        <mat-accordion displayMode="flat" multi="true">
            <app-filters-list></app-filters-list>
        </mat-accordion>
    </mat-sidenav>
    <mat-sidenav-content>   
        <div fxLayout="row" *ngIf="product">

            <div fxFlex="100" fxFlex.gt-md="73" fxLayout="column">

                    <div fxLayout="row" fxLayout.lt-md="column">

                        <div fxFlex="100" fxFlex.gt-md="60" fxFlex.md="55">

                            <h2 class="product-detail-title">{{product?.name}}</h2>
                            <div class="mb-2">
                                <app-rating [ratingsCount]="product?.ratingsCount" [ratingsValue]="product?.ratingsValue" [direction]="'row'"></app-rating>
                            </div>

                            <mat-card class="product-image">
                                <button mat-icon-button (click)="openZoomViewer()" fxHide="false" fxHide.gt-md><mat-icon>fullscreen</mat-icon></button>
                                <ng-container *ngIf="selectedImage">
                                    <div *ngIf="product?.specialLabel" class="product-item-image-speciallabel">
                                        {{product.specialLabel}}
                                    </div>
                                    <img
                                        *ngIf="selectedImage.have_image"
                                        [src]="image"
                                        (mousemove)="onMouseMove($event)"
                                        (mouseleave)="onMouseLeave($event)"/>
                                    <img *ngIf="!selectedImage.have_image" [src]="image" class="no-product-image">
                                </ng-container>
                            </mat-card>

                            <div class="small-carousel" *ngIf="product">
                                <div class="swiper-container" [swiper]="config">
                                    <div class="swiper-wrapper">
                                        <div *ngFor="let image of product?.images" class="swiper-slide">
                                            <mat-card (click)="selectImage(image)" class="p-1">
                                                <span *ngIf="image.have_image">
                                                    <img [src]="image.small" class="swiper-lazy"/>
                                                </span>
                                            </mat-card>
                                        </div>
                                    </div>
                                    <button mat-icon-button class="swiper-button-prev swipe-arrow"><mat-icon>keyboard_arrow_left</mat-icon></button>
                                    <button mat-icon-button class="swiper-button-next swipe-arrow"><mat-icon>keyboard_arrow_right</mat-icon></button>
                                </div>
                            </div>
                        </div>
                        <div fxFlex ngClass.gt-sm="px-3 m-0" ngClass.md="pl-3" ngClass.sm="mt-2" ngClass.xs="mt-2">

                            <h2 class="mb-2 new-price">{{product?.newPrice | customCurrency}}</h2>
                            <div [innerHTML]="product?.demoUnitText" class="product_deals_wrapper"></div>

                            <div #zoomViewer fxShow="false" fxShow.gt-md>
                                <mat-card *ngIf="zoomImage" class="zoom-viewer mat-elevation-z18"></mat-card>
                            </div>

                            <!-- <div class="py-1 lh">
                                <p><span class="text-muted fw-500">Category: </span><span>{{ product?.category_name }}</span></p>
                                <p><span class="text-muted fw-500">Availibility: </span><span>{{ (product?.availibilityCount > 0) ? 'In stock':'Unavailable'}}</span></p>
                            </div>
                            <div class="divider mt-1"></div>

                            <div fxLayout="row" fxLayout.xs="column" fxLayoutAlign="space-between center" class="details text-muted py-1">
                                <div *ngFor="let attribute of product?.attributes; let i=index;">
                                    <ng-container *ngIf="attribute.listtype == 'select'">
                                        <mat-form-field>
                                            <mat-select [placeholder]="attribute.products_options_name" (selectionChange)="attributeSelected(i, $event)">
                                                <mat-option *ngFor="let option of attribute.values" [value]="option.products_options_values_id">
                                                    {{option.products_options_values_name}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </ng-container>
                                </div>
                            </div> -->

                            <div fxLayout="column" class="product-detail-control mb-2">
                                <!-- <app-controls [product]="product" [type]="'all'"></app-controls> -->
                                <button class="control-add-to-cart" mat-button *ngIf="product?.availibilityCount > 0" (click)="appService.addToCart(product, 1, true)"><ng-container i18n>Add to cart</ng-container> <i class="fas fa fa-shopping-cart"></i></button>
                                <button class="control-normal" mat-button><ng-container i18n>Collect in store</ng-container><i class="fas fa fa-chevron-circle-right"></i></button>
                                <button class="control-normal" mat-button (click)="requestBestPrice()"><ng-container i18n>Request best price</ng-container><i class="fas fa fa-chevron-circle-right"></i></button>
                                <button class="control-deal" mat-button><ng-container i18n>SUMMERDEAL</ng-container><i class="fas fa fa-chevron-circle-right"></i></button>
                                <button class="control-normal" mat-button><ng-container i18n>Action: Exchange your TV</ng-container><i class="fas fa fa-chevron-circle-right"></i></button>
                            </div>

                            <div [innerHTML]="product?.stockIndicator" class="new-stock-info-wrapper"></div>                        

                            <!-- <div class="bezorg-title" i18n>Stock delivery</div>
                                <div class="new-stock-info-bezorg">
                                    <div class="bezorg-cms-title">
                                        <p><a href="#"><i class="fas fa fa-circle"></i><ng-container i18n>Order today, receive tomorrow</ng-container></a></p>
                                    </div>
                                </div>
                                <div class="new-stock-info-winkel">
                                    <div class="winkel-title" i18n>Stock store</div>
                                    <div class="r-row r-col-2">
                                        <div class="winkel-branch-city-stock overlib-popup"><i class="fas fa fa-circle"></i> <a href="/pagina_cms?type=amsterdam-voorraadstatus-msg-green" rel="lyteframe" i18n-title title="Click for more info" rev="width: 640px; height: 480px; scrolling: yes;"><span i18n>Amsterdam</span></a></div>
                                        <div class="winkel-branch-city-stock overlib-popup"><i class="fas fa fa-circle"></i> <a href="/pagina_cms?type=utrecht-voorraadstatus-msg-green" rel="lyteframe" i18n-title title="Click for more info" rev="width: 640px; height: 480px; scrolling: yes;"><span i18n>Utrecht</span></a></div>
                                        <div class="winkel-branch-city-stock overlib-popup"><i class="fas fa fa-circle"></i> <a href="/pagina_cms?type=breda-voorraadstatus-msg-green" rel="lyteframe" i18n-title title="Click for more info" rev="width: 640px; height: 480px; scrolling: yes;"><span i18n>Breda</span></a></div>
                                        <div class="winkel-branch-city-stock overlib-popup"><i class="fas fa fa-circle"></i> <a href="/pagina_cms?type=arnhem-voorraadstatus-msg-green" rel="lyteframe" i18n-title title="Click for more info" rev="width: 640px; height: 480px; scrolling: yes;"><span i18n>Arnhem</span></a></div>
                                        <div class="winkel-branch-city-stock overlib-popup"><i class="fas fa fa-circle"></i> <a href="/pagina_cms?type=doetinchem-voorraadstatus-msg-green" rel="lyteframe" i18n-title title="Click for more info" rev="width: 640px; height: 480px; scrolling: yes;"><span i18n>Doetinchem</span></a></div>
                                        <div class="winkel-branch-city-stock overlib-popup"><i class="fas fa fa-circle"></i> <a href="/pagina_cms?type=nijmegen-voorraadstatus-msg-green" rel="lyteframe" i18n-title title="Click for more info" rev="width: 640px; height: 480px; scrolling: yes;"><span i18n>Nijmegen</span></a></div>
                                        <div class="winkel-branch-city-stock overlib-popup"><i class="fas fa fa-circle"></i> <a href="/pagina_cms?type=doesburg-voorraadstatus-msg-green" rel="lyteframe" i18n-title title="Click for more info" rev="width: 640px; height: 480px; scrolling: yes;"><span i18n>Doesburg</span></a></div>
                                        <div class="winkel-branch-city-stock overlib-popup"><i class="fas fa fa-circle"></i> <a href="/pagina_cms?type=eindhoven-voorraadstatus-msg-green" rel="lyteframe" i18n-title title="Click for more info" rev="width: 640px; height: 480px; scrolling: yes;"><span i18n>Eindhoven</span></a></div>
                                    </div>
                                </div>
                            </div>

                            <div class="divider"></div> 

                        <div fxLayout="row" fxLayoutAlign="space-between center" class="text-muted py-1">
                                <button mat-button><mat-icon>mail_outline</mat-icon> Email to a Friend</button>
                                <button mat-icon-button><mat-icon>share</mat-icon></button>
                            </div> --> 
                        </div>
                    </div>
                    <div class="mt-2">

                        <div ngClass.gt-md="pr-3">

                            <div class="shortdesc"><p class="py-1 text-muted lh" [innerHTML]="product?.shortdescription | htmlSanitize"></p></div>

                            <div fxFlex>
                                <mat-card *ngIf="product?.description || product?.extra_description || product?.reviews.length || product?.expertReview">
                                    <mat-tab-group [@.disabled]="true" [selectedIndex]="0">
                                        <mat-tab label="Beschrijving" class="mat-tab-beschrijving" *ngIf="product?.description">
                                            <div class="full-desc mat-tab-beschrijving" ngClass.xs="py-2" ngClass.lt-md="p-2">
                                                <p [innerHTML]="product?.description | htmlSanitize"></p>
                                                <p [innerHTML]="product?.featureHighlights | htmlSanitize"></p>
                                            </div>
                                        </mat-tab>
                                        <mat-tab label="Specificaties" *ngIf="product?.extra_description">
                                            <div class="full-desc mat-tab-specificaties" ngClass.xs="py-2" ngClass.lt-md="p-2">
                                                <p [innerHTML]="product?.extra_description | htmlSanitize"></p>
                                            </div>
                                        </mat-tab>
                                        <mat-tab label="Reviews" *ngIf="product?.reviews.length">
                                            <div class="full-desc mat-tab-reviews" ngClass.xs="py-2" ngClass.lt-md="p-2">
                                                <div [innerHTML]="product?.reviews" class="reviews-item"></div>
                                            </div>
                                        </mat-tab>
                                        <mat-tab label="Plus- en minpunten" *ngIf="product?.expertReview">
                                            <div class="full-desc mat-tab-plus-en-min" ngClass.xs="py-2" ngClass.lt-md="p-2">
                                                <p [innerHTML]="product?.expertReview | htmlSanitize"></p>
                                            </div>
                                        </mat-tab>
                                    </mat-tab-group>
                                </mat-card>
                            </div>
                        </div>

                    </div>
            </div>
            <div fxFlex fxHide fxShow.gt-md>
                <app-extra-info></app-extra-info>
            </div>
        </div>
    </mat-sidenav-content>
</mat-sidenav-container>
<div class="py-2 mt-2">
    <h2 i18n>Related Products</h2>
    <div class="divider"></div>
    <app-products-carousel [products]="relatedProducts"></app-products-carousel>
</div>
