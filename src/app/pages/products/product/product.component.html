<mat-sidenav-container>
    <mat-sidenav #sidenav [opened]="sidenavOpen" [mode]="sidenavOpen ? 'side' : 'over'" class="filter-sidenav" perfectScrollbar>
        <mat-accordion displayMode="flat" multi="true">
            <app-filters-list></app-filters-list>
        </mat-accordion>
    </mat-sidenav>
    <mat-sidenav-content>   
        <div fxLayout="row" *ngIf="product">

            <div fxFlex="100" fxFlex.gt-md="77" fxLayout="column">

                    <div fxLayout="row" fxLayout.lt-md="column">

                        <div fxFlex="100" fxFlex.gt-sm="55">

                            <h2 class="product-detail-title">{{product?.name}}</h2>
                            <div class="mb-2">
                                <app-rating [ratingsCount]="product?.ratingsCount" [ratingsValue]="product?.ratingsValue" [direction]="'row'"></app-rating>
                            </div>

                            <mat-card class="product-image">
                                <button mat-icon-button (click)="openZoomViewer()" fxHide="false" fxHide.gt-md><mat-icon>fullscreen</mat-icon></button>
                                <ng-container *ngIf="selectedImage">
                                    <div *ngIf="product?.specialLabel" class="product-item-image-speciallabel">
                                        {{product.specialLabel}}
                                    </div>
                                    <img
                                        *ngIf="selectedImage.have_image"
                                        [attr.ix-path]="image" ix-params='{"auto":"compress"}' 
                                        (mousemove)="onMouseMove($event)"
                                        sizes="(min-width: 768px) 360px, (min-width: 320px) 370px, 100vw"
                                        alt=""
                                        (mouseleave)="onMouseLeave($event)"/>
                                    <img *ngIf="!selectedImage.have_image" [attr.ix-path]="image" ix-params='{"auto":"compress"}'  class="no-product-image" alt="">
                                </ng-container>
                            </mat-card>

                            <div class="small-carousel" *ngIf="product">
                                <div class="swiper-container" [swiper]="config">
                                    <div class="swiper-wrapper">
                                        <div *ngFor="let image of product?.images" class="swiper-slide">
                                            <mat-card (click)="selectImage(image)" class="p-1">
                                                <span *ngIf="image.have_image">
                                                    <img [attr.ix-path]="image.small" ix-params='{"auto":"compress"}' sizes="(min-width: 768px) 80px, (min-width: 320px) 90px, 100vw"  class="swiper-lazy" alt=""/>
                                                </span>
                                            </mat-card>
                                        </div>
                                    </div>
                                    <button mat-icon-button class="swiper-button-prev swipe-arrow"><mat-icon>keyboard_arrow_left</mat-icon></button>
                                    <button mat-icon-button class="swiper-button-next swipe-arrow"><mat-icon>keyboard_arrow_right</mat-icon></button>
                                </div>
                            </div>
                        </div>
                        <div fxFlex ngClass.gt-sm="px-3 m-0" ngClass.md="pl-3" ngClass.sm="mt-2" ngClass.xs="mt-2">

                            <h2 class="mb-2 new-price">{{product?.newPrice | customCurrency}}</h2>
                            <div [innerHTML]="product?.demoUnit" class="product_deals_wrapper"></div>

                            <div #zoomViewer fxShow="false" fxShow.gt-md>
                                <mat-card *ngIf="zoomImage" class="zoom-viewer mat-elevation-z18"></mat-card>
                            </div>

                            <div fxLayout="column" class="product-detail-control mb-2">
                                <button class="control-add-to-cart" mat-button *ngIf="product?.availibilityCount > 0" (click)="appService.addToCart(product, 1, true)"><ng-container i18n>Add to cart</ng-container> <fa-icon [icon]="'shopping-cart'"></fa-icon></button>
                                <button class="control-normal" mat-button><ng-container i18n>Collect in store</ng-container><fa-icon [icon]="'chevron-circle-right'"></fa-icon></button>
                                <button class="control-normal" mat-button (click)="requestBestPrice()"><ng-container i18n>Request best price</ng-container><fa-icon [icon]="'chevron-circle-right'"></fa-icon></button>
                                <button class="control-deal" mat-button (click)="exchangeProduct()"><ng-container i18n>SUMMERDEAL</ng-container><fa-icon [icon]="'chevron-circle-right'"></fa-icon></button>
                                <button class="control-normal" mat-button><ng-container i18n>Action: Exchange your TV</ng-container><fa-icon [icon]="'chevron-circle-right'"></fa-icon></button>
                            </div>

                            <div class="new-stock-info-wrapper">{{product?.stockIndicator}}</div>

                            <div class="winkel-stock">
                                <h3>Bezorgvoorraad</h3>
                                <div><fa-icon [icon]="'circle'"></fa-icon><a href='/'>GREEN Voor 18:00 besteld, morgen in huis</a></div>

                                <h3>Winkelvoorraad</h3>
                                <div fxLayout="row wrap">
                                    <div *ngFor="let store of stores" fxFlex="50">
                                        <fa-icon [icon]="'circle'"></fa-icon><a [routerLink]="['/stores', store.store_location]">{{store.store_location}}</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-2" fxLayout fxLayout.lt-md="column" fxLayoutAlign="space-between start">
                        <div fxFlex="55" fxFlex.lt-md="false">
                            <h3>{{product.name}}</h3>
                            <div class="shortdesc"><p class="py-1 text-muted lh" [innerHTML]="product?.shortdescription | htmlSanitize"></p></div>
                            <ng-container *ngIf="product?.featureHighlights">
                                <h3>Kenmerken</h3>
                                <p [innerHTML]="product.featureHighlights | htmlSanitize"></p>
                            </ng-container>
                        </div>
                        <div fxFlex="44" fxFlex.lt-md="false" ngClass.gt-md="pr-3 m-0" *ngIf="product?.description || product?.extra_description || product?.reviews.length || product?.expertReview">
                            <div class="extra-infos extra-infos-list">
                                <h2>BEKIJK OOK</h2>
                                <div class="extra-infos-link">
                                    <div *ngIf="product?.expertReview" (click)="scrollToElement(info_expert_reviews)"><fa-icon [icon]="'circle'"></fa-icon>Plus- en minpunten</div>
                                    <div *ngIf="product?.reviews.length" (click)="scrollToElement(info_reviews)"><fa-icon [icon]="'circle'"></fa-icon>Reviews</div>
                                    <div *ngIf="product?.description" (click)="scrollToElement(info_description)"><fa-icon [icon]="'circle'"></fa-icon>Beschrijving</div>
                                    <div *ngIf="product?.extra_description" (click)="scrollToElement(info_extra_description)"><fa-icon [icon]="'circle'"></fa-icon>Specificaties</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-2">

                        <div ngClass.gt-md="pr-3">

                            <div fxFlex class="extra-infos">
                                <div #info_expert_reviews>
                                    <div *ngIf="product?.expertReview">
                                        <h2>Plus- en minpunten</h2>
                                        <div class="mat-tab-plus-en-min" ngClass.xs="py-2" ngClass.lt-md="p-2">
                                            <p [innerHTML]="product?.expertReview | htmlSanitize"></p>
                                        </div>
                                    </div>
                                </div>
                                <div #info_reviews>
                                    <div *ngIf="product?.reviews.length">
                                        <h2>Reviews</h2>
                                        <div ngClass.xs="py-2" ngClass.lt-md="p-2">
                                            <div class="reviews-item" *ngFor="let review of product.reviews">
                                                <app-rating [review]="review.reviewScore" [ratingsCount]="1000" [ratingsValue]="review.ratingScore/10" [direction]="'row'"></app-rating>
                                                <!-- <strong>{{review.reviewContent}}</strong> -->
                                                <p>{{review.reviewAuthor}} | {{review.dateAdded}}</p>
                                                <br>
                                                <ng-container *ngIf="review.reviewPoints.plus || review.reviewPoints.plus">
                                                    <div fxLayout>
                                                        <div fxFlex *ngIf="review.reviewPoints.plus">
                                                            <p *ngFor="let plus of review.reviewPoints.plus">
                                                                <fa-icon class="fa-plus" [icon]="'plus'"></fa-icon> {{plus}}
                                                            </p>
                                                        </div>
                                                        <div fxFlex *ngIf="review.reviewPoints.minus">
                                                            <p *ngFor="let minus of review.reviewPoints.minus">
                                                                <fa-icon class="fa-minus" [icon]="'minus'"></fa-icon> {{minus}}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <br>
                                                </ng-container>
                                                <div>{{review.reviewContent}}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div #info_description>
                                    <div *ngIf="product?.description">
                                        <h2>Beschrijving</h2>
                                        <div class="mat-tab-beschrijving" ngClass.xs="py-2" ngClass.lt-md="p-2">
                                            <p [innerHTML]="product?.description | htmlSanitize"></p>
                                        </div>
                                    </div>
                                </div>
                                <div #info_extra_description>
                                    <div *ngIf="product?.extra_description">
                                        <h2>Specificaties</h2>
                                        <div class="mat-tab-specificaties" ngClass.xs="py-2" ngClass.lt-md="p-2">
                                            <p [innerHTML]="product?.extra_description | htmlSanitize"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
            </div>
            <div fxFlex fxHide fxShow.gt-md>
                <app-extra-info></app-extra-info>
            </div>
        </div>
    </mat-sidenav-content>
</mat-sidenav-container>
<div class="py-2 mt-2">
    <h2 i18n>Related Products</h2>
    <div class="divider"></div>
    <app-products-carousel [products]="relatedProducts"></app-products-carousel>
</div>
